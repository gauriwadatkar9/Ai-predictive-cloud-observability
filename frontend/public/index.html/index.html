<!DOCTYPE html>
<html>
<head>
    <title>AI Cloud Observability Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #0f172a;
            color: #e2e8f0;
        }

        header {
            padding: 20px;
            font-size: 22px;
            font-weight: bold;
            border-bottom: 1px solid #1e293b;
        }

        .container {
            padding: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background: #1e293b;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
        }

        .card h3 {
            margin-top: 0;
            border-bottom: 1px solid #334155;
            padding-bottom: 10px;
        }

        .risk-score {
            font-size: 40px;
            font-weight: bold;
        }

        button {
            padding: 10px 15px;
            border: none;
            background: #3b82f6;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #2563eb;
        }

        input {
            padding: 8px;
            margin: 5px;
            border-radius: 5px;
            border: none;
        }
    </style>
</head>

<body>

<header>
    AI-Powered Predictive Cloud Observability Platform
</header>

<div class="container">

    <div class="grid">

        <div class="card">
            <h3>System Metrics Input</h3>
            CPU: <input type="number" id="cpu" value="90"><br>
            Memory: <input type="number" id="memory" value="85"><br>
            Errors: <input type="number" id="errors" value="8"><br><br>
            <button onclick="analyze()">Analyze System</button>
        </div>

        <div class="card">
            <h3>Predictive Risk Score</h3>
            <div class="risk-score" id="riskScore">--</div>
        </div>

        <div class="card">
            <h3>Clustered Incident</h3>
            <div id="incident">--</div>
        </div>

        <div class="card">
            <h3>AI Root Cause Explanation</h3>
            <div id="explanation">--</div>
        </div>

        <div class="card">
            <h3>CPU Usage Chart</h3>
            <canvas id="cpuChart"></canvas>
        </div>

        <div class="card">
            <h3>Memory Usage Chart</h3>
            <canvas id="memoryChart"></canvas>
        </div>

    </div>
</div>

<script>

async function analyze() {
    const cpu = parseFloat(document.getElementById("cpu").value);
    const memory = parseFloat(document.getElementById("memory").value);
    const errors = parseInt(document.getElementById("errors").value);

    const response = await fetch("http://127.0.0.1:8000/analyze", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ cpu, memory, errors })
    });

    const data = await response.json();

    document.getElementById("riskScore").innerText = data.risk_score;
    document.getElementById("incident").innerText = data.incident;
    document.getElementById("explanation").innerText = data.ai_explanation;

    updateCharts(cpu, memory);
}

let cpuChart = new Chart(document.getElementById("cpuChart"), {
    type: "line",
    data: {
        labels: [],
        datasets: [{
            label: "CPU Usage",
            data: [],
            borderColor: "#3b82f6",
            fill: false
        }]
    }
});

let memoryChart = new Chart(document.getElementById("memoryChart"), {
    type: "line",
    data: {
        labels: [],
        datasets: [{
            label: "Memory Usage",
            data: [],
            borderColor: "#10b981",
            fill: false
        }]
    }
});

function updateCharts(cpu, memory) {
    const time = new Date().toLocaleTimeString();

    cpuChart.data.labels.push(time);
    cpuChart.data.datasets[0].data.push(cpu);
    cpuChart.update();

    memoryChart.data.labels.push(time);
    memoryChart.data.datasets[0].data.push(memory);
    memoryChart.update();
}

</script>

</body>
</html>